# Railway Deployment Checklist

## Pre-Deployment (Completed âœ…)

- âœ… Updated `railway.toml` with complete build command including npm build
- âœ… Verified `npm run build` works locally (Vite assets compile successfully)
- âœ… Verified `composer install` dependencies can be resolved
- âœ… APP_KEY is set and ready: `base64:BmmZ993rARtI3Qb2Fs8X0Bh3gLE+rUI1dfe434LMqxs=`
- âœ… Created comprehensive deployment guide: `RAILWAY_DEPLOYMENT_GUIDE.md`

## Railway Dashboard Setup Steps

### Step 1: Create Railway Project
- [ ] Go to https://railway.app
- [ ] Click "New Project"
- [ ] Select "GitHub" and authorize
- [ ] Select this repository (`laravel/tracking`)

### Step 2: Add MySQL Database
- [ ] In Railway project, click "Add Service"
- [ ] Select "Database" â†’ "MySQL"
- [ ] Railway auto-configures with `DB_HOST`, `DB_DATABASE`, etc.

### Step 3: Configure App Environment Variables
Add these variables in the app service settings:

**Required Variables:**
```
APP_NAME=sales_tracking
APP_ENV=production
APP_DEBUG=false
APP_KEY=base64:BmmZ993rARtI3Qb2Fs8X0Bh3gLE+rUI1dfe434LMqxs=
APP_URL=[YOUR_RAILWAY_DOMAIN]
LOG_CHANNEL=stack
LOG_LEVEL=info
```

**Session & Cache:**
```
SESSION_DRIVER=database
SESSION_LIFETIME=120
CACHE_STORE=database
QUEUE_CONNECTION=database
```

**Optional/Pre-configured:**
```
APP_LOCALE=en
APP_FALLBACK_LOCALE=en
FILESYSTEM_DISK=local
MAIL_MAILER=log
```

**Database (Auto-linked - no need to add manually):**
```
DB_CONNECTION=mysql
DB_HOST=${{MySQL.PRIVATE_URL}}
DB_PORT=3306
DB_DATABASE=${{MySQL.DB_NAME}}
DB_USERNAME=${{MySQL.DB_USER}}
DB_PASSWORD=${{MySQL.DB_PASSWORD}}
```

### Step 4: Deploy
- [ ] After adding MySQL and environment variables, Railway triggers automatic deploy
- [ ] Check "Deployments" tab for progress
- [ ] Verify in logs:
  - Composer dependencies installed
  - npm packages installed
  - Vite build completed
  - Database migrations ran
  - Server started on port

### Step 5: Verify Live Site
- [ ] Open your Railway app URL (format: `your-app-name.up.railway.app`)
- [ ] Should see login page
- [ ] Try logging in or creating account
- [ ] Check database is working

## Important Notes

1. **APP_URL**: Must match your Railway domain exactly (e.g., `https://fuel-tracking-system.up.railway.app`)
   - Find this in Railway dashboard under your app service name
   - Replace placeholder in environment variables

2. **Build Process**: 
   - Runs automatically on every push to main/deploy branch
   - Includes: `composer install`, `npm install`, `npm run build`, migrations

3. **Migrations**:
   - Run automatically on every deployment
   - If you need to rollback, use Railway's "Revert" button

4. **Database**:
   - MySQL service must be added (not just created, but added to your project)
   - Environment variables are auto-generated by Railway

5. **Static Assets**:
   - Built to `public/build/` by Vite
   - Served automatically by Laravel
   - Clear browser cache if assets don't update

## Troubleshooting

### Deployment fails in build step
- Check build logs in Railway dashboard
- Verify all files committed to git
- Ensure `package.json` and `composer.json` exist in root

### Database connection error
- Verify MySQL service is running (check "Services" tab)
- Ensure private Railway URL is used: `${{MySQL.PRIVATE_URL}}`
- Restart app service if database was recently added

### 404 on routes
- Ensure `APP_URL` environment variable matches Railway domain
- Check that routes are in `routes/web.php`
- Verify not accessing with different domain

### Assets not loading (404 on /build/assets)
- Check build logs to verify `npm run build` succeeded
- Confirm `public/build/` directory was created
- Clear browser cache (Ctrl+Shift+Delete)
- Restart app service

## Contact & Support

- Railway Docs: https://docs.railway.app/
- Laravel Docs: https://laravel.com/docs/deployment
- For specific Railway issues: Check logs in Railway dashboard

## Files Modified/Created

- âœ… `railway.toml` - Updated build and start commands
- âœ… `RAILWAY_DEPLOYMENT_GUIDE.md` - Comprehensive deployment guide
- âœ… `RAILWAY_DEPLOYMENT_CHECKLIST.md` - This file

Ready to deploy! ðŸš€
